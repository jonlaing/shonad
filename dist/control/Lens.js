"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k);var desc=Object.getOwnPropertyDescriptor(m,k);desc&&("get"in desc?m.__esModule:!desc.writable&&!desc.configurable)||(desc={enumerable:!0,get:function(){return m[k]}}),Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){o[k2=void 0===k2?k:k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0}),exports.nonEmptyDict=exports.nonEmptyList=exports.nonEmptyString=exports.when=exports.or=exports.prop=exports.index=exports.tail=exports.head=exports.optional=exports.compose=exports.pipe=exports.over=exports.set=exports.viewE=exports.view=exports.lens=void 0;const Fn=__importStar(require("../base/Function")),Maybe=__importStar(require("../data/Maybe")),List=__importStar(require("../data/List")),Dict=__importStar(require("../data/Dict")),Either=__importStar(require("../data/Either")),lens=(getter,setter)=>({get:getter,set:setter}),pipe=(exports.lens=lens,exports.view=Fn.curry((lens,data)=>lens.get(data)),exports.viewE=Fn.curry((lens,error,data)=>Either.fromMaybe(error,(0,exports.view)(lens,data))),exports.set=Fn.curry((lens,val,data)=>lens.set(val,data)),exports.over=Fn.curry((lens,f,data)=>lens.set(f(lens.get(data)),data)),(...lenses)=>{if(1===lenses.length)return lenses[0];const[l0,l1,...rest]=lenses;lenses={get:Fn.compose(l0.get,l1.get),set:(a,x)=>l1.set(l0.set(a,l1.get(x)),x)};return(0,exports.pipe)(lenses,...rest)}),compose=(exports.pipe=pipe,(...lenses)=>(0,exports.pipe)(...List.reverse(lenses))),optional=(exports.compose=compose,fallback=>({get:a=>Maybe.fromMaybe(fallback,a),set:(v,data)=>Maybe.just(v)})),index=(exports.optional=optional,exports.head={get:List.head,set:(mx,xs)=>Maybe._do(function*(_){return[_(yield mx),..._(yield List.tail(xs))]}).unwrap(xs)},exports.tail={get:List.tail,set:(mxs,xs)=>Maybe._do(function*(_){var tail=_(yield mxs);return[_(yield List.head(xs)),...tail]}).unwrap(xs)},i=>({get:List.nth(i),set:(mx,xs)=>mx.fmap(x=>List.update(x,i,xs)).unwrap(xs)})),prop=(exports.index=index,k=>({get:Dict.get(k),set:(mv,dict)=>mv.fmap(Dict.set(k)).apply(Maybe.pure(dict)).unwrap(dict)})),or=(exports.prop=prop,(l1,l0)=>(0,exports.lens)(a=>Maybe.or(()=>l1.get(a),()=>l0.get(a)),(mv,a)=>l0.get(a).fmap(_=>l0.set(mv,a)).unwrap(l1.set(mv,a)))),when=(exports.or=or,pred=>(0,exports.lens)(List.find(pred),(mv,xs)=>mv.fmap(List.updateWhen(pred)).apply(Maybe.pure(xs)).unwrap(xs)));exports.when=when,exports.nonEmptyString=(0,exports.lens)(a=>""===a?Maybe.nothing():Maybe.just(a),(mv,a)=>mv.unwrap("")),exports.nonEmptyList=(0,exports.lens)(a=>List.isEmpty(a)?Maybe.nothing():Maybe.just(a),(mv,a)=>mv.unwrap([])),exports.nonEmptyDict=(0,exports.lens)(a=>Dict.isEmpty(a)?Maybe.nothing():Maybe.just(a),(mv,a)=>mv.unwrap({}));
//# sourceMappingURL=Lens.js.map